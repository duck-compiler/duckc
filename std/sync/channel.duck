struct Channel<T> = {
    inner: go "chan {T}"
} impl {
    fn send(x: T) {
        go {
            (*self).inner <- x
        }
    }

    fn recv() -> T {
        return go {
            return <-(*self).inner
        }
    }
};

fn new_channel<T>() -> Channel<T> {
    const go_chan: go "chan {T}";

    go {
        go_chan = make(chan <<<T>>>)
    }

    return Channel<T> {
        inner: go_chan,
    };
}
